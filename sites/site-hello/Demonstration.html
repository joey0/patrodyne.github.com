<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Mar 11, 2012 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title></title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20120311" />
    <meta http-equiv="Content-Language" content="en" />
        
                			    		<!-- Flattr Script -->
		<script type="text/javascript">/* <![CDATA[ */
		(function() {
			var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
			s.type = 'text/javascript';
			s.async = true;
			s.src = 'http://api.flattr.com/js/0.6/load.js?mode=auto';
			t.parentNode.insertBefore(s, t);
		})();
		/* ]]> */</script>
    </head>
  <body class="composite">
    <div id="banner">
                                                    <a href="index.html" id="bannerLeft">
                                                              <img src="images/logos/HelloDemo.png" alt="Patrodyne Hello Demo" />
                      </a>
                                      <div id="bannerRight">
                              <a class="FlattrButton" style="display:none;" rev="flattr;button:compact;" href="http://patrodyne.org/"></a>
        <noscript>
          <a href="http://flattr.com/thing/446287/Patrodyne" target="_blank">
            <img src="http://api.flattr.com/button/flattr-badge-large.png" alt="Flattr this" title="Flattr this" border="0" />
          </a>
        </noscript>
              </div>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
        
                <div class="xleft">
        <span id="publishDate">Last Published: 2012-03-11</span>
                  &nbsp;| <span id="projectVersion">Version: 1.0.4-SNAPSHOT</span>
                      </div>
            <div class="xright">                    <a href="sitemap.html" title="sitemap">sitemap</a>
              
        
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
        
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Introduction">Introduction</a>
            </li>
                                                                                                                                                                                                                                                                                                <li class="expanded">
            <strong>Demonstration</strong>
                  <ul>
                                                                                                                              <li class="expanded">
                          <a href="Demonstration.html#Configuration" title="Configuration">Configuration</a>
                    <ul>
                      <li class="none">
                          <a href="Demonstration.html#Installer" title="Installer">Installer</a>
            </li>
                                                                                    <li class="expanded">
                          <a href="Demonstration.html#Shortcut" title="Shortcut">Shortcut</a>
                    <ul>
                      <li class="none">
                          <a href="Demonstration.html#Linux" title="Linux">Linux</a>
            </li>
                      <li class="none">
                          <a href="Demonstration.html#Windows" title="Windows">Windows</a>
            </li>
              </ul>
        </li>
              </ul>
        </li>
                                                                                                                                                            <li class="expanded">
                          <a href="Demonstration.html#Folders" title="Folders">Folders</a>
                    <ul>
                      <li class="none">
                          <a href="Demonstration.html#Binaries" title="Binaries">Binaries</a>
            </li>
                      <li class="none">
                          <a href="Demonstration.html#Configurations" title="Configurations">Configurations</a>
            </li>
                      <li class="none">
                          <a href="Demonstration.html#Icons" title="Icons">Icons</a>
            </li>
                      <li class="none">
                          <a href="Demonstration.html#Libraries" title="Libraries">Libraries</a>
            </li>
                      <li class="none">
                          <a href="Demonstration.html#Logging" title="Logging">Logging</a>
            </li>
                      <li class="none">
                          <a href="Demonstration.html#Packs" title="Packs">Packs</a>
            </li>
              </ul>
        </li>
              </ul>
        </li>
                                                                                                                                                                                            <li class="collapsed">
                          <a href="pom.html" title="POM">POM</a>
                  </li>
                  <li class="none">
                          <a href="faq.html" title="FAQ">FAQ</a>
            </li>
          </ul>
                       <h5>Download</h5>
                  <ul>
                  <li class="none">
                          <a href="install.jnlp" title="Install">Install</a>
            </li>
                  <li class="none">
                          <a href="http://search.maven.org/#search|ga|1|a%3A%22patrodyne-site-hello%22" class="externalLink" title="Artifacts">Artifacts</a>
            </li>
                  <li class="none">
                          <a href="https://github.com/patrodyne/patrodyne-site/tarball/master" class="externalLink" title="Tarball">Tarball</a>
            </li>
                  <li class="none">
                          <a href="https://github.com/patrodyne/patrodyne-site/zipball/master" class="externalLink" title="Zipball">Zipball</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                              <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                                              <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                       <h5>Powered By</h5>
                                                                                                                             <a href="http://maven.apache.org/" title="Maven" class="poweredBy">
        <img class="poweredBy"  alt="Maven" src="http://maven.apache.org/images/logos/maven-feather.png"    />
      </a>
                                                                                                    <a href="https://github.com/patrodyne/patrodyne-site/tree/master/hello" title="GitHub" class="poweredBy">
        <img class="poweredBy"  alt="GitHub" src="https://github.com/github/media/blob/master/logos/github_logo_social_coding_outlined.png?raw=true"   width="90"  height="30" />
      </a>
                                                                                                    <a href="http://flattr.com/thing/446287/Patrodyne" title="Flattr" class="poweredBy">
        <img class="poweredBy"  alt="Flattr" src="http://api.flattr.com/button/flattr-badge-large.png"    />
      </a>
                                                                                                    <a href="http://izpack.org/" title="IzPack" class="poweredBy">
        <img class="poweredBy"  alt="IzPack" src="http://media.xircles.codehaus.org/_projects/izpack/_logos/tiny.png"    />
      </a>
                                                                                                    <a href="http://cooltext.com" title="CoolText" class="poweredBy">
        <img class="poweredBy"  alt="CoolText" src="http://cooltext.com/images/ct_pixel.gif"   width="80"  height="15" />
      </a>
                                                                                                    <a href="license.html" title="LGPLv3" class="poweredBy">
        <img class="poweredBy"  alt="LGPLv3" src="http://www.gnu.org/graphics/lgplv3-88x31.png"    />
      </a>
                       
        
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Installer Demo<a name="Installer_Demo"></a></h2><p>Reference: <a class="externalLink" href="http://izpack.org/documentation/index.html">IzPack Documentation</a></p><p>This project builds a Swing based <tt>Hello</tt> application; but, this project is not about that! Instead, it <i>is</i> about the installer used to set it up on the end-user's system. There are various ways to distribute an application, the most common being: tarball, zip, package, and installer. The first two distribution types require the user to 'wire-up' the application by adding short cuts and menu entries. The last two types ease the set-up by automating or guiding the user through the set-up options. Packaging is great for Linux systems; but, it is not so common on other systems. By providing an installer, an end-user can quickly get our <tt>Hello</tt> started. Better yet, you can use this configuration to create an installer for <i>your</i> cool application, too!</p><p>Fortunately, the kind folks at <a class="externalLink" href="http://izpack.org">IzPack</a> have done most of the work for us. We only need to configure for our needs. If you are not familiar with <i>IzPack</i>, take a moment to browse their <a class="externalLink" href="http://izpack.org/documentation/index.html">documentation</a> then come back here to see how we put it to use.</p><p>At Patrodyne, we use Maven to build everything and for <i>IzPack</i> we use <a class="externalLink" href="http://izpack.codehaus.org/izpack-maven-plugin/">izpack-maven-plugin</a>. The plugin has a default location for the <i>IzPack</i> files, in the <tt>src/izpack</tt> folder. Here is the layout...</p><div class="source"><pre>patrodyne-site/hello/src/izpack
|-- bin
|   |-- Hello
|   |-- Hello.cmd
|   |-- native
|   |   `-- izpack
|   |       |-- ShellLink.dll
|   |       `-- ShellLink_x64.dll
|   `-- Uninstall
|-- cfg
|   |-- log4j.dtd
|   |-- log4j.xml
|   |-- logback.xml
|   `-- logging.properties
|-- icons
|   |-- Hello.ico
|   |-- Hello.png
|   |-- uninstaller.ico
|   `-- uninstaller.png
|-- lib
|   `-- ext
|-- log
|-- packs
|   `-- logger
|       |-- jul
|       |-- log4j
|       |-- logback
|       `-- simple
|-- InstallerLeft.png
|-- install.xml
|-- README.html
|-- linux_shortcuts.xml
`-- winos_shortcuts.xml</pre></div><div class="section"><h3><a name="Configuration">Configuration</a></h3><p>We use three configuration files to define how our installation will be packaged and how it will operate: <tt>install.xml</tt>, <tt>linux_shortcuts.xml</tt> and <tt>winos_shortcuts.xml</tt>. The content of these files is specified by <i>IzPack</i> and they are processed by a Maven plugin. In the POM, the <tt>izpack-maven-plugin</tt> declares its <tt>descriptor</tt> to be this <tt>install.xml</tt>. The <tt>install.xml</tt> declares the shortcuts to complete the configuration.</p><p>The configuration files refer to other resources, as describe further down this page.</p><div class="section"><h4><a name="Installer">Installer</a> XML<a name="Installer_XML"></a></h4><p>We begin the <tt>install.xml</tt> with information describing our project and ourselves. Conveniently, we can include properties from the POM to keep things <a class="externalLink" href="http://en.wikipedia.org/wiki/Don%27t_repeat_yourself">DRY</a>. <i>IzPack</i> puts this info on the first panel that the end-user sees.</p><div class="section"><h5>Info<a name="Info"></a></h5><div class="source"><pre>&lt;info&gt;
    &lt;appname&gt;${project.name}&lt;/appname&gt;
    &lt;appversion&gt;${project.version}&lt;/appversion&gt;
    &lt;appsubpath&gt;Patrodyne/${project.artifactId}/${project.version}&lt;/appsubpath&gt;
    &lt;authors&gt;
        &lt;author name=&quot;Patrodyne&quot; email=&quot;rick.osullivan@patrodyne.org&quot;/&gt;
    &lt;/authors&gt;
    &lt;url&gt;${project.url}&lt;/url&gt;
    &lt;javaversion&gt;1.6&lt;/javaversion&gt;
    &lt;requiresjdk&gt;no&lt;/requiresjdk&gt;
&lt;/info&gt;</pre></div><p>For the application name, we use the POM's project name. The name of our poject is <i>Hello</i>. It is an informal name that we use when speaking about our project in conversation. In contrast, the artifact name is more formal: <tt>patrodyne-site-hello</tt>.</p><p>The sub-path determines where our project will be installed, relative to the installation path. In other words, after the end-user selects the installation path, the sub-path is created in it. Our sub-path has three parts:</p><ol style="list-style-type: decimal"><li>Patrodyne - our group name ensures that this project and all of our other fine projects are grouped together.</li><li><tt>$<a name="project.artifactId">project.artifactId</a></tt> - the artifact id, from the POM, provides a well-defined name for this project.</li><li><tt>$<a name="project.version">project.version</a></tt> - a place for each version and each version in its own place!</li></ol></div><div class="section"><h5>Variables<a name="Variables"></a></h5><div class="source"><pre>&lt;variables&gt;
    &lt;variable name=&quot;CFG_DIR&quot; value=&quot;${cfgdir}&quot;/&gt;
    &lt;variable name=&quot;EXT_DIR&quot; value=&quot;${extdir}&quot;/&gt;
    &lt;variable name=&quot;ICN_DIR&quot; value=&quot;${icndir}&quot;/&gt;
    &lt;variable name=&quot;LIB_DIR&quot; value=&quot;${libdir}&quot;/&gt;
    &lt;variable name=&quot;LOG_DIR&quot; value=&quot;${logdir}&quot;/&gt;
    &lt;variable name=&quot;FINAL_NAME&quot; value=&quot;${project.build.finalName}&quot;/&gt;
&lt;/variables&gt;</pre></div><p>We define some <i>IzPack</i> variables here so we can use them in the <a href="#Shortcut">Shortcut</a> files.</p></div><div class="section"><h5>Dynamic Variables<a name="Dynamic_Variables"></a></h5><div class="source"><pre>&lt;dynamicvariables&gt;
    &lt;variable 
        name=&quot;JVM_CFG_LOG&quot; 
        value=&quot;logback.configurationFile=${cfgdir}/logback.xml&quot; 
        condition=&quot;LogbackSelected&quot;
    /&gt;
    &lt;variable
        name=&quot;JVM_CFG_LOG&quot;
        value=&quot;log4j.configuration=file:${cfgdir}/log4j.xml&quot;
        condition=&quot;Log4jSelected&quot;
    /&gt;
    &lt;variable
        name=&quot;JVM_CFG_LOG&quot;
        value=&quot;java.util.logging.config.file=${cfgdir}/logging.properties&quot;
        condition=&quot;JULSelected&quot;
    /&gt;
&lt;/dynamicvariables&gt;</pre></div><p>Dynamic variables are cool. The value is determined based on conditions determined by the end-user's choices. For example, the <i>Hello</i> installation gives the user an option to choose one of three popular logging frameworks: <i>logback</i>, <i>log4j</i> or <i>jul</i>. The value of <tt>JVM_CFG_LOG</tt> will correspond to the selected logging framework.</p><p>Hint: You'll see <tt>JVM_CFG_LOG</tt> later when we declare the command line options for launching the <i>Hello</i> application.</p></div><div class="section"><h5>Conditions<a name="Conditions"></a></h5><div class="source"><pre>&lt;conditions&gt;
    &lt;condition type=&quot;PackSelection&quot; id=&quot;LogbackSelected&quot;&gt;
        &lt;packid&gt;Logback&lt;/packid&gt;
    &lt;/condition&gt;
    &lt;condition type=&quot;PackSelection&quot; id=&quot;Log4jSelected&quot;&gt;
        &lt;packid&gt;Log4j&lt;/packid&gt;
    &lt;/condition&gt;
    &lt;condition type=&quot;PackSelection&quot; id=&quot;JULSelected&quot;&gt;
        &lt;packid&gt;JUL&lt;/packid&gt;
    &lt;/condition&gt;
    
    &lt;condition type=&quot;not&quot; id=&quot;LogbackIsSelectable&quot;&gt;
        &lt;condition type=&quot;or&quot; id=&quot;LogbackIsNotSelectable&quot;&gt;
            &lt;condition type=&quot;ref&quot; refid=&quot;Log4jSelected&quot; /&gt;
            &lt;condition type=&quot;ref&quot; refid=&quot;JULSelected&quot; /&gt;
        &lt;/condition&gt;
    &lt;/condition&gt;
    &lt;condition type=&quot;not&quot; id=&quot;Log4jIsSelectable&quot;&gt;
        &lt;condition type=&quot;or&quot; id=&quot;Log4jIsNotSelectable&quot;&gt;
            &lt;condition type=&quot;ref&quot; refid=&quot;LogbackSelected&quot; /&gt;
            &lt;condition type=&quot;ref&quot; refid=&quot;JULSelected&quot; /&gt;
        &lt;/condition&gt;
    &lt;/condition&gt;
    &lt;condition type=&quot;not&quot; id=&quot;JULIsSelectable&quot;&gt;
        &lt;condition type=&quot;or&quot; id=&quot;JULIsNotSelectable&quot;&gt;
            &lt;condition type=&quot;ref&quot; refid=&quot;LogbackSelected&quot; /&gt;
            &lt;condition type=&quot;ref&quot; refid=&quot;Log4jSelected&quot; /&gt;
        &lt;/condition&gt;
    &lt;/condition&gt;
&lt;/conditions&gt;</pre></div><p>In this installation, we use <i>conditions</i> to determine which one of three logging frameworks is selectable:</p><ul><li><tt>LogbackIsSelectable</tt> - as the default, it will be preselected.</li><li><tt>Log4jIsSelectable</tt> - false until no other logger is selected.</li><li><tt>JULIsSelectable</tt> - false until no other logger is selected.<p>We use this information to implement a set of radio buttons. First we set a condition to detect which pack is selected:</p></li><li><tt>LogbackSelected</tt> - true, when the Logback option is checkmarked.</li><li><tt>Log4jSelected</tt> - true, when the Log4j option is checkmarked.</li><li><tt>JULSelected</tt> - true, when the Java Utility Logger option is checkmarked.<p>Next, we set a <tt>*IsNotSelectable</tt> condition when any of the other options is selected.</p><p>Finally, we negate <tt>*IsNotSelectable</tt> to determine <tt>*IsSelectable</tt>.</p><p>We'll use these conditions later in the Packs section.</p></li></ul></div><div class="section"><h5>GUI Preferences<a name="GUI_Preferences"></a></h5><div class="source"><pre>&lt;guiprefs width=&quot;800&quot; height=&quot;500&quot; resizable=&quot;no&quot; /&gt;</pre></div><p>In this element, we set the dimensions of the <i>IzPack</i> installer window to a nice rectangles and disable resizing, to keep things simple.</p><p>Nice rectangles have sides corresponding to consecutive <a class="externalLink" href="http://en.wikipedia.org/wiki/Fibonacci_number">Fibonacci</a> numbers: 1, 1, 2, 3, 5, 8, 13, etc. In this case, we choose 5 and 8 (times 100).</p></div><div class="section"><h5>Locale<a name="Locale"></a></h5><div class="source"><pre>&lt;locale&gt;
    &lt;langpack iso3=&quot;eng&quot; /&gt;
&lt;/locale&gt;</pre></div><p>Until we learn to translate &quot;Hello&quot; into other languages, this installation will only support English.</p></div><div class="section"><h5>Resources<a name="Resources"></a></h5><div class="source"><pre>&lt;resources&gt;
    &lt;res id=&quot;Installer.image&quot;       src=&quot;InstallerLeft.png&quot; /&gt;
    &lt;res id=&quot;Unix_shortcutSpec.xml&quot; src=&quot;linux_shortcuts.xml&quot; /&gt;
    &lt;res id=&quot;shortcutSpec.xml&quot;      src=&quot;winos_shortcuts.xml&quot; /&gt;
&lt;/resources&gt;</pre></div><p>To display a picture on the left side of the <i>IzPack</i> installer window, we define a resource with a magic id, <tt>Installer.image</tt>. Supported image formats are GIF, JPEG and PNG.</p><p>Another magic id, <tt>Unix_shortcutSpec.xml</tt> defines a resource for <a href="#Linux">Linux desktop shortcuts</a>.</p><p>And another magic id, <tt>shortcutSpec.xml</tt> defines a resource for <a href="#Windows">Windows desktop shortcuts</a>.</p></div><div class="section"><h5>Panels<a name="Panels"></a></h5><div class="source"><pre>&lt;panels&gt;
    &lt;panel classname=&quot;HelloPanel&quot;/&gt;
    &lt;panel classname=&quot;TargetPanel&quot;/&gt;       
    &lt;panel classname=&quot;TreePacksPanel&quot;/&gt;
    &lt;panel classname=&quot;SummaryPanel&quot;/&gt;
    &lt;panel classname=&quot;InstallPanel&quot;/&gt;           
    &lt;panel classname=&quot;ShortcutPanel&quot;/&gt;
    &lt;panel classname=&quot;FinishPanel&quot;/&gt;
&lt;/panels&gt;</pre></div><p><a class="externalLink" href="http://izpack.org/documentation/panels.html#hellopanel">HelloPanel</a> - This panel welcomes the user by displaying the project name, the version, the URL as well as the authors.</p><p><a class="externalLink" href="http://izpack.org/documentation/panels.html#targetpanel">TargetPanel</a> - This panel allows the user to select the installation path. </p><p><a class="externalLink" href="http://izpack.org/documentation/panels.html#treepackspanel">TreePacksPanel</a> - Using a tree-like structure, this allows the user to select the packs s/he wants to install.</p><p><a class="externalLink" href="http://izpack.org/documentation/panels.html#summarypanel">SummaryPanel</a> - This panel gives a summary of all shown panels.</p><p><a class="externalLink" href="http://izpack.org/documentation/panels.html#installpanel">InstallPanel</a> - This panel launches the installation process!</p><p><a class="externalLink" href="http://izpack.org/documentation/panels.html#shortcutpanel">ShortcutPanel</a> - This panel is used to create desktop shortcuts.</p><p><a class="externalLink" href="http://izpack.org/documentation/panels.html#finishpanel">FinishPanel</a> - A ending panel, able to write automated installer information.</p><p>For a complete list of available panels, see <a class="externalLink" href="http://izpack.org/documentation/panels.html">IzPack Panels</a>.</p></div><div class="section"><h5>Packs<a name="Packs"></a></h5><div class="source"><pre>&lt;packs&gt;
    &lt;pack name=&quot;Core&quot; required=&quot;yes&quot;&gt;
        &lt;description&gt;Core installation files&lt;/description&gt;
        &lt;file src=&quot;README.html&quot; targetdir=&quot;${INSTALL_PATH}&quot;/&gt;
        &lt;file src=&quot;../${FINAL_NAME}.jar&quot; targetdir=&quot;${INSTALL_PATH}&quot;/&gt;
        &lt;fileset dir=&quot;${libdir}&quot; targetdir=&quot;${INSTALL_PATH}/${libdir}&quot;&gt;
            &lt;include name=&quot;**&quot;/&gt;
        &lt;/fileset&gt;
        &lt;!-- Unix --&gt;
        ...
        &lt;!-- Windows --&gt;
        ...
    &lt;/pack&gt;
    &lt;pack name=&quot;Logger&quot; required=&quot;yes&quot;&gt;
        ...
    &lt;/pack&gt;
    &lt;pack name=&quot;Logback&quot; parent=&quot;Logger&quot; required=&quot;no&quot; 
        preselected=&quot;yes&quot; condition=&quot;LogbackIsSelectable&quot;&gt;
        ...
    &lt;/pack&gt;
    &lt;pack name=&quot;Log4j&quot; parent=&quot;Logger&quot; required=&quot;no&quot; 
        preselected=&quot;no&quot; condition=&quot;Log4jIsSelectable&quot;&gt;
        ...
    &lt;/pack&gt;
    &lt;pack name=&quot;JUL&quot; parent=&quot;Logger&quot; required=&quot;no&quot; 
        preselected=&quot;no&quot; condition=&quot;JULIsSelectable&quot;&gt;
        ...
    &lt;/pack&gt;
&lt;/packs&gt;</pre></div><p>Packs contain our application and optional features. <i>IzPack</i> provides Ant-like actions to gather files, artifacts, libraries and other resources to create an installer package. The <i>Hello</i> installer defines five packs:</p><ol style="list-style-type: decimal"><li><tt>Core</tt> - The <i>Hello</i> application is comprised of a <tt>jar</tt> and additional libraries. We add a <tt>README.html</tt> to explain our cool app, too. This pack includes conditional actions depending of the target operating system.</li><li><tt>Logger</tt> - A wrapper to group the logging options.</li><li><tt>Logback</tt> - A pack containing the Logback libraries and settings file. This is preselected to be the default option.</li><li><tt>Log4j</tt> - A pack containing the Log4j libraries and settings file.</li><li><tt>JUL</tt> - A pack containing the Java Utility Logger libraries and settings file.</li></ol><p>Note: We use the <tt>LogbackIsSelectable</tt>, <tt>Log4jIsSelectable</tt>, and <tt>JULIsSelectable</tt> conditions defined earlier to dynamically maintain the checkboxes as a set of radio buttons.</p></div><div class="section"><h5>Native<a name="Native"></a></h5><div class="source"><pre>&lt;native type=&quot;izpack&quot; name=&quot;ShellLink.dll&quot;&gt;
    &lt;os family=&quot;windows&quot; /&gt;
&lt;/native&gt;

&lt;native type=&quot;izpack&quot; name=&quot;ShellLink_x64.dll&quot;&gt;
    &lt;os family=&quot;windows&quot;/&gt;
&lt;/native&gt;</pre></div><p>These native libraries are used to create desktop shortcuts in Windows.</p></div></div><div class="section"><h4><a name="Shortcut">Shortcut</a> XML<a name="Shortcut_XML"></a></h4><p>A desktop shortcut is a small file containing the name of a target program to launch. The shortcut may specify additional parameters to be passed to the program when it is run. Each shortcut can have its own icon. Shortcuts are commonly placed on a desktop, in an application launcher panel, or in the main menu of a desktop environment.</p><p>In <i>IzPack</i> we specify how and where desktop shortcuts are installed with the aid of an XML configuration file. </p><div class="section"><h5><a name="Linux">Linux</a> Shortcuts<a name="Linux_Shortcuts"></a></h5><p>In Linux, shortcuts can be added to the desktop and to the application menu.</p><div class="section"><h6>Overview<a name="Overview"></a></h6><div class="source"><pre>&lt;shortcuts&gt;
    &lt;skipIfNotSupported/&gt;
    &lt;defaultCurrentUser/&gt;
    &lt;shortcut 
        ... Specification Attributes ...
        ... Control Attributes ...
        ... Linux Attributes ...
    &gt;
        &lt;createForPack name=&quot;Core&quot;/&gt;
    &lt;/shortcut&gt;
&lt;/shortcuts&gt;</pre></div><p>As the root, the <tt>shortcuts</tt> element contains a few global settings and wraps one or more <tt>shortcut</tt> definitions.</p><p>The <tt>skipIfNotSupported</tt> element is used when the target operating system does not support shortcuts. This tag omits the panel on non-supported systems. </p><p>The <tt>defaultCurrentUser</tt> specifies to use &quot;current user&quot; as the default selection. If not specified then &quot;all users&quot; is the default selection, when supported.</p><p>The <tt>shortcut</tt> element has several attributes to be discussed below. It contains sub-elements to create the shortcut only if the specified pack is actually installed.</p></div><div class="section"><h6>Specification Attributes, in <tt>shortcut</tt> element<a name="Specification_Attributes_in_shortcut_element"></a></h6><div class="source"><pre>name=&quot;${APP_NAME}&quot;
description=&quot;Launch ${APP_NAME}&quot;
target=&quot;java&quot;
commandLine=&quot;-D${JVM_CFG_LOG} -Djava.ext.dirs=${EXT_DIR} 
    -jar &amp;quot;${INSTALL_PATH}/${FINAL_NAME}.jar&amp;quot;&quot;
workingDirectory=&quot;${INSTALL_PATH}&quot;
iconFile=&quot;${INSTALL_PATH}/${ICN_DIR}/${APP_NAME}.png&quot;
initialState=&quot;normal&quot;</pre></div><p>The <tt>name</tt> element is defined using a built-in variable which, in the <i>Hello</i> installation, traces back to the POM project name.</p><p>The <tt>description</tt> is usually displayed as a tool tip for the shortcut.</p><p>The <tt>target</tt> is the program to be launched. We use &quot;java&quot; as the program and use the <tt>commandLine</tt> attribute to specify the jar containing our <i>Hello</i> application.</p><p>The <tt>commandLine</tt> contains the arguments to be passed to the <tt>target</tt> program. In this demonstration, the setting is dynamically defined using previously set variables. The <tt>JVM_CFG_LOG</tt> value is a dynamic variable set in the <a href="#Installer">Installer</a> XML based on the user's choice of the logging framework.</p><p>The <tt>workingDirectory</tt> defines the start-up path when the <i>Hello</i> application is launched.</p><p>The <tt>iconFile</tt> is an image for both the desktop and the menu icon, 48x48 pixels is a good size.</p><p>The <tt>initialState</tt> is &quot;normal&quot; but it is not used on Linux.</p></div><div class="section"><h6>Control Attributes, in <tt>shortcut</tt> element<a name="Control_Attributes_in_shortcut_element"></a></h6><div class="source"><pre>desktop=&quot;yes&quot;
programGroup=&quot;yes&quot;
applications=&quot;no&quot;
startMenu=&quot;no&quot;
startup=&quot;no&quot;</pre></div><p>These settings are sufficient to place a shortcut on the desktop and in the application menu.</p></div><div class="section"><h6>Linux Attributes, in <tt>shortcut</tt> element<a name="Linux_Attributes_in_shortcut_element"></a></h6><div class="source"><pre>categories=&quot;Application;Office;&quot;
type=&quot;Application&quot;
terminal=&quot;false&quot;
encoding=&quot;UTF-8&quot;</pre></div><p>The <tt>categories</tt> attribute defines a list of suggested <a class="externalLink" href="http://standards.freedesktop.org/menu-spec/latest/apa.html">locatons</a> for the menu shortcut.</p><p>the <tt>type</tt> must be one of Application or Link.</p></div></div><div class="section"><h5><a name="Windows">Windows</a> Shortcuts<a name="Windows_Shortcuts"></a></h5><p>In Windows, shortcuts can be added to the desktop and grouped in the application menu.</p><div class="section"><h6>Overview<a name="Overview"></a></h6><div class="source"><pre>&lt;shortcuts&gt;
    &lt;skipIfNotSupported/&gt;
    &lt;programGroup defaultName=&quot;Patrodyne\${APP_NAME}&quot;
        location=&quot;applications&quot;/&gt;
    &lt;defaultCurrentUser/&gt;
    &lt;shortcut 
        ... Hello Launcher ...
    &gt;
        &lt;createForPack name=&quot;Core&quot;/&gt;
    &lt;/shortcut&gt;

    &lt;shortcut
        ... Uninstaller ...
    &gt;
        &lt;createForPack name=&quot;Core&quot; /&gt;
    &lt;/shortcut&gt;
&lt;/shortcuts&gt;</pre></div><p>The <tt>programGroup</tt> defines a sub-menu where we will place two shortcuts, one for the launcher and one for the uninstaller.</p></div><div class="section"><h6>Hello Launcher<a name="Hello_Launcher"></a></h6><div class="source"><pre>name=&quot;${APP_NAME}&quot;
description=&quot;Launch ${APP_NAME}&quot;
target=&quot;java&quot;
commandLine=&quot;-D${JVM_CFG_LOG} -Djava.ext.dirs=${EXT_DIR} 
    -jar &amp;quot;${INSTALL_PATH}/${FINAL_NAME}.jar&amp;quot;&quot;
workingDirectory=&quot;${INSTALL_PATH}&quot;
iconFile=&quot;${INSTALL_PATH}/${ICN_DIR}/${APP_NAME}.ico&quot;
iconIndex=&quot;0&quot;
initialState=&quot;noShow&quot;

desktop=&quot;yes&quot;
programGroup=&quot;yes&quot;
applications=&quot;no&quot;
startMenu=&quot;no&quot;
startup=&quot;no&quot;</pre></div><p>The <tt>iconFile</tt> refers to a <tt>*.ico</tt> icon which, by nature, contains a few images of different sizes.</p><p>The <tt>iconIndex</tt> defines which image to use.</p><p>The <tt>initialState</tt> is <tt>noShow</tt> to hide the shell window and deference to the <i>Hello</i> application.</p></div><div class="section"><h6>Uninstaller<a name="Uninstaller"></a></h6><div class="source"><pre>name=&quot;Uninstall ${APP_NAME}&quot;
description=&quot;Launch uninstaller&quot;
target=&quot;java&quot;
commandLine=&quot;-jar 
    &amp;quot;${INSTALL_PATH}/Uninstaller/uninstaller.jar&amp;quot;&quot;
workingDirectory=&quot;${INSTALL_PATH}&quot;
iconFile=&quot;${INSTALL_PATH}/${ICN_DIR}/uninstaller.ico&quot;
iconIndex=&quot;0&quot;
initialState=&quot;noShow&quot;

desktop=&quot;no&quot;
programGroup=&quot;yes&quot;
applications=&quot;no&quot;
startMenu=&quot;no&quot;
startup=&quot;no&quot;</pre></div><p>No <tt>desktop</tt> shortcut, but we will put a <tt>programGroup</tt> shortcut for the Uninstaller in the menu.</p></div></div></div></div><div class="section"><h3><a name="Folders">Folders</a></h3><p>In addition to the XML configurations, we use several sub-directories to group related resouces.</p><div class="section"><h4><a name="Binaries">Binaries</a> &amp; Scripts<a name="Binaries__Scripts"></a></h4><p>The <tt>bin</tt> folder contains native libraries and launch scripts.</p><div class="section"><h5>Native Libraries<a name="Native_Libraries"></a></h5><ul><li><tt>native/izpack/ShellLink.dll</tt> - The native library required for 32 bit Windows operating systems.</li><li><tt>native/izpack/ShellLink_x64.dllcl</tt> - The native library required for 64 bit Windows operating systems.</li></ul></div><div class="section"><h5>Launch Scripts<a name="Launch_Scripts"></a></h5><ul><li><tt>Hello</tt> - a shell script for Linux to launch the <i>Hello</i> application.</li><li><tt>Hello.cmd</tt> - a command script for Windows to launch the <i>Hello</i> application.</li><li><tt>Uninstall</tt> - a shell script for Linux to reverse the <i>Hello</i> installation. </li></ul><div class="section"><h6>Hello<a name="Hello"></a></h6><div class="source"><pre>#!/bin/sh
java -D%{JVM_CFG_LOG} -Djava.ext.dirs=%{EXT_DIR} \
    -jar &quot;%{INSTALL_PATH}/%{FINAL_NAME}.jar&quot;
# vi:set tabstop=4 hardtabs=4 shiftwidth=4:</pre></div><p>This Linux script is used to launch the <i>Hello</i> application from the desktop or the command line. The first line, known as the shebang, tells Linux how to run the script. It specifies the standard shell. The second line starts a Java Virtual Machine (JVM) to run <i>Hello</i>. The third line instructs Vi or Vim to use tabs of length 4.</p><p>The <tt>-D%<a name="JVM_CFG_LOG">JVM_CFG_LOG</a></tt> defines a JVM system property to configure the selected logging framework. For Logback, the definition is <tt>logback.configurationFile=cfg/logback.xml</tt>.</p><p>The <tt>-Djava.ext.dirs=%<a name="EXT_DIR">EXT_DIR</a></tt> tells the JVM to extend the classpath to include all jars in the <tt>%<a name="EXT_DIR">EXT_DIR</a></tt> directory; which, in our configuration, expands to <tt>lib/ext</tt>. Our <tt>install.xml</tt> copies the jars for the selected logging framework to the extension path for dynamic, pluggable class loading.</p><p>The <tt>-jar</tt> option tells the JVM to run main class, as specified in the jar's <tt>META-INF/MANIFEST.MF</tt> file. The <tt>INSTALL_PATH</tt> is selected by the user and the <tt>FINAL_NAME</tt> refers to project's build final name as defined in the POM.</p></div><div class="section"><h6>Hello.cmd<a name="Hello.cmd"></a></h6><div class="source"><pre>@echo off
@start &quot;%{APP_NAME}&quot; /D&quot;%{INSTALL_PATH}&quot; javaw -D%{JVM_CFG_LOG} ^
    -Djava.ext.dirs=%{EXT_DIR} -jar &quot;%{INSTALL_PATH}/%{FINAL_NAME}.jar&quot;
@rem vi:set tabstop=4 hardtabs=4 shiftwidth=4:</pre></div><p>This Windows script is used to launch the <i>Hello</i> application from the desktop or the command line. The definitions are similar to the LInux script, above. The difference is how the JVM is started. In order to detach the application from the command window, the <tt>start</tt> command is used.</p></div><div class="section"><h6>Uninstall<a name="Uninstall"></a></h6><div class="source"><pre>#!/bin/sh
java -jar &quot;%{INSTALL_PATH}/Uninstaller/uninstaller.jar&quot;
# vi:set tabstop=4 hardtabs=4 shiftwidth=4:</pre></div><p>This Linux script calls the main class of the <tt>uninstaller.jar</tt>, as prepared by <i>IzPack</i>.</p></div></div></div><div class="section"><h4><a name="Configurations">Configurations</a></h4><p>For the <i>Hello</i> installation, we use the <tt>cfg</tt> folder to store various logging configurations files. Only the settings file for the selected log framework is installed.</p><ul><li><tt>log4j.dtd</tt> - Document Type Definition for Log4j settings file.</li><li><tt>log4j.xml</tt> - settings file for the Log4j logger.</li><li><tt>logback.xml</tt> - settings file for the Logback logger.</li><li><tt>logging.properties</tt> - settings file for the Java Utility Logger.</li></ul></div><div class="section"><h4><a name="Icons">Icons</a></h4><p>Images files for Windows and Linux are used for desktop and menu shortcuts:</p><ul><li><tt>Hello.ico</tt> - Windows icon file with three images of size 48, 32, and 16 pixels, square.</li><li><tt>Hello.png</tt> - Linux portable network graphic, 48 pixels square.</li><li><tt>uninstaller.ico</tt> - Windows icon.</li><li><tt>uninstaller.png</tt> - Linux portable network graphic.</li></ul></div><div class="section"><h4><a name="Libraries">Libraries</a> &amp; Extensions<a name="Libraries__Extensions"></a></h4><p>Placeholder folders:</p><ul><li><tt>lib</tt> - static dependency jars.</li><li><tt>lib/ext</tt> - dynamic dependency jars.</li></ul></div><div class="section"><h4><a name="Logging">Logging</a></h4><p>Placeholder folder.</p></div><div class="section"><h4><a name="Packs">Packs</a></h4><p>Placeholder folders:</p><ul><li><tt>logger/jul</tt></li><li><tt>logger/log4j</tt></li><li><tt>logger/logback</tt></li><li><tt>logger/simple</tt></li></ul></div></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2012
                        <a href="http://patrodyne.org">Patrodyne</a>.
            All Rights Reserved.      
        
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
